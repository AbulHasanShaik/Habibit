jQuery(document).ready(function(o){var e=geocoder=marker=map_marker=infowindow="";function t(e,t,n,a){a&&(document.getElementById("mvx_user_location").value=e),document.getElementById("mvx_user_location_lat").value=t,document.getElementById("mvx_user_location_lng").value=n,o(document.body).trigger("update_checkout")}function n(o,t,n){google.maps.event.addListener(t,"click",function(){o.setContent(n),o.open(e,t)})}$mvx_user_location_lat=jQuery("#mvx_user_location_lat").val(),$mvx_user_location_lng=jQuery("#mvx_user_location_lng").val(),jQuery("#mvx_user_location_lat").length>0&&setTimeout(function(){!function(){if(mvx_checkout_map_options.mapbox_emable){mapboxgl.accessToken=mvx_checkout_map_options.mapbox_emable;var e=new mapboxgl.Map({container:"mvx-user-locaton-map",style:"mapbox://styles/mapbox/streets-v11",center:[mvx_checkout_map_options.default_lat,mvx_checkout_map_options.default_lng],zoom:parseInt(mvx_checkout_map_options.default_zoom)}),a=new MapboxGeocoder({accessToken:mapboxgl.accessToken,marker:{color:"red"},mapboxgl:mapboxgl});e.on("load",function(){a.on("result",function(e){document.getElementById("mvx_user_location").value=e.result.place_name,document.getElementById("mvx_user_location_lat").value=e.result.center[0],document.getElementById("mvx_user_location_lng").value=e.result.center[1],o(document.body).trigger("update_checkout")})}),e.addControl(a),e.addControl(new mapboxgl.NavigationControl)}else{var c=new google.maps.LatLng(mvx_checkout_map_options.default_lat,mvx_checkout_map_options.default_lng,13);e=new google.maps.Map(document.getElementById("mvx-user-locaton-map"),{center:c,mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:parseInt(mvx_checkout_map_options.default_zoom)});var r={url:mvx_checkout_map_options.store_icon,scaledSize:new google.maps.Size(mvx_checkout_map_options.icon_width,mvx_checkout_map_options.icon_height)};marker=new google.maps.Marker({map:e,position:c,animation:google.maps.Animation.DROP,icon:r,draggable:!0});var m=document.getElementById("mvx_user_location");geocoder=new google.maps.Geocoder;var i=new google.maps.places.Autocomplete(m);i.bindTo("bounds",e),infowindow=new google.maps.InfoWindow,i.addListener("place_changed",function(){infowindow.close(),marker.setVisible(!1);var o=i.getPlace();o.geometry?(o.geometry.viewport?e.fitBounds(o.geometry.viewport):(e.setCenter(o.geometry.location),e.setZoom(parseInt(mvx_checkout_map_options.default_zoom))),marker.setPosition(o.geometry.location),marker.setVisible(!0),t(o.formatted_address,o.geometry.location.lat(),o.geometry.location.lng(),!1),infowindow.setContent(o.formatted_address),infowindow.open(e,marker),n(infowindow,marker,o.formatted_address)):window.alert("Autocomplete returned place contains no geometry")}),google.maps.event.addListener(marker,"dragend",function(){geocoder.geocode({latLng:marker.getPosition()},function(o,a){a==google.maps.GeocoderStatus.OK&&o[0]&&(t(o[0].formatted_address,marker.getPosition().lat(),marker.getPosition().lng(),!0),infowindow.setContent(o[0].formatted_address),infowindow.open(e,marker),n(infowindow,marker,o[0].formatted_address))})})}}(),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(o){$current_location_fetched=!0,mvx_checkout_map_options.mapbox_emable||geocoder.geocode({location:{lat:o.coords.latitude,lng:o.coords.longitude}},function(a,c){if("OK"===c){t(a[0].formatted_address,o.coords.latitude,o.coords.longitude,!0);var r=new google.maps.LatLng(o.coords.latitude,o.coords.longitude);marker.setPosition(r),marker.setVisible(!0),infowindow.setContent(a[0].formatted_address),infowindow.open(e,marker),n(infowindow,marker,a[0].formatted_address)}})})},1e3)});