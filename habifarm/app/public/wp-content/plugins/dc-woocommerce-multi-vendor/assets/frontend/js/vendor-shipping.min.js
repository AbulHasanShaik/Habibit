!function(i){if("undefined"==typeof mvx_vendor_shipping_script_data)return!1;var t=t||{build:function(){this.init(),this.bindEvents()},init:function(){this.modify_shipping_methods=".modify-shipping-methods",this.vendor_shipping_methods="#vendor-shipping-methods",this.shipping_by_zone_holder="#mvx_settings_form_shipping_by_zone",this.shipping_zone_table=this.shipping_by_zone_holder+" .shipping-zone-table",this.shipping_zone_list=".shipping-zone-list",this.shipping_method_manage_form="#mvx_shipping_method_manage_form",this.show_shipping_methods=this.vendor_shipping_methods+" .show-shipping-methods",this.add_shipping_methods=this.vendor_shipping_methods+" .add-shipping-method",this.edit_shipping_method=this.vendor_shipping_methods+" .edit-shipping-method",this.update_shipping_method=this.vendor_shipping_methods+" .update-shipping-method",this.delete_shipping_method=this.vendor_shipping_methods+" .delete-shipping-method",this.limit_zone_location=this.vendor_shipping_methods+" #limit_zone_location",this.method_status=this.vendor_shipping_methods+" .method-status",this.modal_close_link=".modal-close-link",this.modal_dialog=".mvx-modal-dialog"},bindEvents:function(){i(this.modify_shipping_methods).on("click",this.modifyShippingMethods.bind(this)),i(document).on("zone_settings_loaded",this.zoneLoadedEvents.bind(this)),i(document.body).on("change",".wc-shipping-zone-method-selector select",this.onChangeShippingMethodSelector),i(document).delegate(this.shipping_zone_list,"click",this.goToShippingZones.bind(this)),i(document).delegate(this.show_shipping_methods,"click",this.showShippingMethods.bind(this)),i(document).delegate(this.add_shipping_methods,"click",this.addShippingMethod.bind(this)),i(document).delegate(this.edit_shipping_method,"click",this.editShippingMethod.bind(this)),i(document).delegate(this.update_shipping_method,"click",this.updateShippingMethod.bind(this)),i(document).delegate(this.delete_shipping_method,"click",this.deleteShippingMethod.bind(this)),i(document).delegate(this.limit_zone_location,"click",this.limitZoneLocation.bind(this)),i(document).delegate(this.method_status,"change",this.toggleShippingMethod.bind(this)),i(document).delegate(this.modal_close_link,"click",this.closeModal.bind(this))},modifyShippingMethods:function(t,e){var n=this;i("#mvx_settings_form_shipping_by_zone").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),void 0!==t&&(t.preventDefault(),e=i(t.currentTarget).data("zoneId")),i.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:{action:"mvx-get-shipping-methods-by-zone",zoneID:e,security:mvx_vendor_shipping_script_data.security},success:function(t){i(n.vendor_shipping_methods).html(t.data.html).show(),i(n.shipping_zone_table).hide()},complete:function(){i("#mvx_settings_form_shipping_by_zone").unblock(),i(document).trigger("zone_settings_loaded")}})},zoneLoadedEvents:function(i){this.limitZoneLocation(i)},goToShippingZones:function(t){t.preventDefault(),i(this.vendor_shipping_methods).html("").hide(),i(this.shipping_zone_table).show(),window.location.reload()},onChangeShippingMethodSelector:function(){var t=i(this).find("option:selected").data("description");i(this).parents(".wc-shipping-zone-method-selector").find(".wc-shipping-zone-method-description").html(""),i(this).parents(".wc-shipping-zone-method-selector").find(".wc-shipping-zone-method-description").html(t)},showShippingMethods:function(t){t.preventDefault(),i("#mvx_shipping_method_add_container").show(),i("#mvx_shipping_method_add_container "+this.modal_dialog).show()},addShippingMethod:function(t){t.preventDefault(),i(this.add_shipping_methods).prop("disabled",!0),i(this.add_shipping_methods).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e=this,n=i("#zone_id").val(),o=i("#shipping_method option:selected").val();if(""==n);else if(""==o);else{var s={action:"mvx-add-shipping-method",zoneID:n,method:o,security:mvx_vendor_shipping_script_data.security};i("#mvx_shipping_method_add_button").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:s,success:function(t){t.success&&(i("#mvx_shipping_method_add_container").hide(),e.modifyShippingMethods(void 0,n))}})}},editShippingMethod:function(t){t.preventDefault(),i(".mvx-zone-method-content").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e=i(t.currentTarget).parents(".edit_del_actions").data("instance_id"),n=i(t.currentTarget).parents(".edit_del_actions").data("method_id"),o=i(t.currentTarget).parents(".edit_del_actions").data("zone_id"),s={action:"mvx-vendor-configure-shipping-method",zoneId:o,instanceId:e,methodId:n,security:mvx_vendor_shipping_script_data.security};i.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:s,success:function(t){t&&(i(".mvx-zone-method-content").unblock(),i("#mvx_shipping_method_edit_container #method_id_selected").val(n),i("#mvx_shipping_method_edit_container #instance_id_selected").val(e),i("#mvx_shipping_method_edit_container #zone_id_selected").val(o),i("#shipping-form-fields").html(t.settings_html),i("#mvx_shipping_method_edit_container").show())}})},updateShippingMethod:function(t){t.preventDefault();var e=this,n=i("#mvx_shipping_method_edit_container #method_id_selected").val(),o=i("#mvx_shipping_method_edit_container #instance_id_selected").val(),s=i("#zone_id").val(),d={action:"mvx-update-shipping-method",zoneID:s,security:mvx_vendor_shipping_script_data.security,args:{instance_id:o,zone_id:s,method_id:n,settings:i("#mvx-vendor-edit-shipping-form").serializeArray()}};i("#mvx_shipping_method_edit_button").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.ajax({method:"POST",url:mvx_vendor_shipping_script_data.ajaxurl,data:d,success:function(i){i.success?e.modifyShippingMethods(void 0,s):alert(i.data)}})},deleteShippingMethod:function(t){t.preventDefault();var e=this;if(confirm(mvx_vendor_shipping_script_data.i18n.deleteShippingMethodConfirmation)){var n=i(t.target).is(this.delete_shipping_method)?t.target:i(t.target).closest(this.delete_shipping_method),o=i(n).parents(".edit_del_actions").attr("data-instance_id"),s=i("#zone_id").val(),d=d={action:"mvx-delete-shipping-method",zoneID:s,instance_id:o,security:mvx_vendor_shipping_script_data.security};""==s||""==o||i.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:d,success:function(i){i.success?e.modifyShippingMethods(void 0,s):alert(resp.data)}})}},limitZoneLocation:function(t){i("#limit_zone_location").is(":checked")?(i(".hide_if_zone_not_limited").show(),i("#select_zone_states").select2()):i(".hide_if_zone_not_limited").hide()},toggleShippingMethod:function(t){t.preventDefault();var e=i(t.target).is(":checked"),n=i(t.target).val(),o=i("#zone_id").val(),s={action:"mvx-toggle-shipping-method",zoneID:o,instance_id:n,checked:e,security:mvx_vendor_shipping_script_data.security};""==o||""==n||(i(".mvx-container").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),i.ajax({method:"post",url:mvx_vendor_shipping_script_data.ajaxurl,data:s,success:function(t){t.success?i(".mvx-container").unblock():(i(".mvx-container").unblock(),alert(t.data))}}))},closeModal:function(t){t.preventDefault();var e=i(t.target).parents(this.modal_dialog);e.length&&(e.hide(),i(this.modal_dialog).hide())}};function e(t){var e=wc_country_select_params.countries.replace(/&quot;/g,'"'),n=i.parseJSON(e),o=t.val();if(n[o]){if(i.isEmptyObject(n[o]))t.parent().find(".mvx_state_to_select").each(function(){$statebox_id=($statebox=i(this)).attr("id"),$statebox_name=$statebox.attr("name"),null===($statebox_val=$statebox.val())&&($statebox_val=""),$statebox_dataname=$statebox.data("name"),$statebox.is("select")&&$statebox.replaceWith('<input type="text" name="'+$statebox_name+'" id="'+$statebox_id+'" data-name="'+$statebox_dataname+'" value="'+$statebox_val+'" class="mvx-text mvx_state_to_select multi_input_block_element" />')});else{input_selected_state="";var s="",d=n[o];t.parent().find(".mvx_state_to_select").each(function(){for(var t in $statebox_id=($statebox=i(this)).attr("id"),$statebox_name=$statebox.attr("name"),null===($statebox_val=$statebox.val())&&($statebox_val=""),$statebox_dataname=$statebox.data("name"),d)if(d.hasOwnProperty(t)){if($statebox_val){if($statebox_val==t)var e='selected="selected"';else var e=""}s=s+'<option value="'+t+'"'+e+">"+d[t]+"</option>"}$statebox.is("select")&&$statebox.html('<option value="">'+wc_country_select_params.i18n_select_state_text+'</option><optgroup label="-------------------------------------"><option value="everywhere">'+mvx_vendor_shipping_script_data.everywhere_else_option+'</option></optgroup><optgroup label="-------------------------------------">'+s+"</optgroup>"),$statebox.is("input")&&($statebox.replaceWith('<select name="'+$statebox_name+'" id="'+$statebox_id+'" data-name="'+$statebox_dataname+'" class="mvx-select mvx_state_to_select multi_input_block_element"></select>'),($statebox=i("#"+$statebox_id)).html('<option value="">'+wc_country_select_params.i18n_select_state_text+'</option><optgroup label="-------------------------------------"><option value="everywhere">'+mvx_vendor_shipping_script_data.everywhere_else_option+'</option></optgroup><optgroup label="-------------------------------------">'+s+"</optgroup>")),$statebox.val($statebox_val)})}}else t.parent().find(".mvx_state_to_select").each(function(){$statebox_id=($statebox=i(this)).attr("id"),$statebox_name=$statebox.attr("name"),null===($statebox_val=$statebox.val())&&($statebox_val=""),$statebox_dataname=$statebox.data("name"),$statebox.is("select")&&$statebox.replaceWith('<input type="text" name="'+$statebox_name+'" id="'+$statebox_id+'" data-name="'+$statebox_dataname+'" value="'+$statebox_val+'" class="mvx-text mvx_state_to_select multi_input_block_element" />')})}i(t.build.bind(t)),i("#shipping-options").change(function(){var t=i(this).val();"distance_by_shipping"==t?(i("#mvx-vendor-shipping-by-distance-section").show(),i("#mvx-vendor-shipping-by-zone-section").hide(),i("#mvx-vendor-shipping-by-country-section").hide()):"distance_by_zone"==t?(i("#mvx-vendor-shipping-by-distance-section").hide(),i("#mvx-vendor-shipping-by-zone-section").show(),i("#mvx-vendor-shipping-by-country-section").hide()):"shipping_by_country"==t&&(i("#mvx-vendor-shipping-by-distance-section").hide(),i("#mvx-vendor-shipping-by-country-section").show(),i("#mvx-vendor-shipping-by-zone-section").hide())}),"distance_by_shipping"==i("#shipping-options").val()?(i("#mvx-vendor-shipping-by-distance-section").show(),i("#mvx-vendor-shipping-by-zone-section").hide(),i("#mvx-vendor-shipping-by-country-section").hide()):"distance_by_zone"==i("#shipping-options").val()?(i("#mvx-vendor-shipping-by-distance-section").hide(),i("#mvx-vendor-shipping-by-zone-section").show(),i("#mvx-vendor-shipping-by-country-section").hide()):"shipping_by_country"==i("#shipping-options").val()&&(i("#mvx-vendor-shipping-by-distance-section").hide(),i("#mvx-vendor-shipping-by-zone-section").hide(),i("#mvx-vendor-shipping-by-country-section").show()),i(".mvx_country_to_select").select2(),i(".mvx-select").select2(),i(".mvx_country_to_select").each(function(){i(this).change(function(){e(i(this))}).change()}),setTimeout(function(){i("#mvx_shipping_rates").children(".multi_input_block").children(".add_multi_input_block").click(function(){i("#mvx_shipping_rates").children(".multi_input_block:last").find(".mvx_country_to_select").select2(),i("#mvx_shipping_rates").children(".multi_input_block:last").find(".mvx_country_to_select").change(function(){e(i(this))}).change()})},2e3),i(".multi_input_holder").each(function(){(function t(e){var n=e.data("limit");void 0===n&&(n=-1),1==e.children(".multi_input_block").length&&e.children(".multi_input_block").children(".remove_multi_input_block").css("display","none"),e.children(".multi_input_block").length==n?e.find(".add_multi_input_block").hide():e.find(".add_multi_input_block").show(),e.children(".multi_input_block").each(function(){i(this)[0]!=e.children(".multi_input_block:last")[0]&&i(this).children(".add_multi_input_block").remove(),i(this).children(".add_multi_input_block").attr("title",mvx_vendor_shipping_script_data.mvx_multiblick_addnew_help),i(this).children(".remove_multi_input_block").attr("title",mvx_vendor_shipping_script_data.mvx_multiblick_remove_help)}),e.children(".multi_input_block").children(".add_multi_input_block").off("click").on("click",function(){var o=e.attr("id"),s=e.data("name"),d=e.data("length");d++;var l=e.children(".multi_input_block:first").clone(!1);l.find("textarea,input:not(input[type=button],input[type=submit],input[type=checkbox],input[type=radio])").val(""),l.find("input[type=checkbox]").attr("checked",!1),l.find(".select2-container").remove(),l.find("select").select2(),l.find("select").select2("destroy"),l.children(".multi_input_block_element:not(.multi_input_holder)").each(function(){var t=i(this),e=t.data("name");t.hasClass("mvx-wp-fields-uploader")||t.hasClass("wp-picker-container")||(t.attr("name",s+"["+d+"]["+e+"]"),t.attr("id",o+"_"+e+"_"+d))}),l.children(".multi_input_holder").each(function(){(function e(n,o,s,d){n.children(".multi_input_block:not(:last)").remove();for(var l=n.attr("id"),h=(l=l.replace(o+"_","")).split("_"),p="",c=0;c<h.length-1;c++)""!=p&&(p+="_"),p+=h[c];n.attr("data-name",s+"["+d+"]["+p+"]"),n.attr("id",o+"_"+p+"_"+d),n.children(".multi_input_block").children(".multi_input_block_element:not(.multi_input_holder)").each(function(){var t=i(this),e=t.data("name");if(t.hasClass("mvx-wp-fields-uploader"));else{var n=t.attr("multiple");void 0!==n&&!1!==n?t.attr("name",s+"["+d+"]["+p+"][0]["+e+"][]"):t.attr("name",s+"["+d+"]["+p+"][0]["+e+"]"),t.attr("id",o+"_"+p+"_"+d+"_"+e+"_0")}}),t(n),n.children(".multi_input_block").children(".multi_input_holder").length>0&&n.children(".multi_input_block").css("padding-bottom","40px"),n.children(".multi_input_block").children(".multi_input_holder").each(function(){e(i(this),o+"_"+p+"_0",s+"["+d+"]["+p+"]",0)})})(i(this),o,s,d)}),l.children(".remove_multi_input_block").off("click").on("click",function(){if(confirm(mvx_vendor_shipping_script_data.multiblock_delete_confirm)){var t=i(this).parent().parent(),e=t.children(".multi_input_block").children(".add_multi_input_block").clone(!0);i(this).parent().remove(),t.children(".multi_input_block").children(".add_multi_input_block").remove(),t.children(".multi_input_block:last").append(e),t.children(".multi_input_block").length==n?t.find(".add_multi_input_block").hide():t.find(".add_multi_input_block").show(),1==t.children(".multi_input_block").length&&t.children(".multi_input_block").children(".remove_multi_input_block").css("display","none")}}),l.children(".add_multi_input_block").remove(),e.append(l),e.children(".multi_input_block:last").append(i(this)),e.children(".multi_input_block").length>1&&e.children(".multi_input_block").children(".remove_multi_input_block").css("display","block"),e.children(".multi_input_block").length==n?e.find(".add_multi_input_block").hide():e.find(".add_multi_input_block").show(),e.data("length",d),e.find(".field_type_options").each(function(){i(this).off("change").on("change",function(){i(this).parent().find(".field_type_select_options").hide(),i(this).parent().find(".field_type_html_options").hide(),"select"==i(this).val()?i(this).parent().find(".field_type_select_options").show():"mselect"==i(this).val()?i(this).parent().find(".field_type_select_options").show():"dropdown"==i(this).val()?i(this).parent().find(".field_type_select_options").show():"html"==i(this).val()&&i(this).parent().find(".field_type_html_options").show()}).change()}),e.find(".custom_field_is_group").each(function(){i(this).change(function(){i(this).is(":checked")?i(this).parent().find(".custom_field_is_group_name").css("visibility","visible"):i(this).parent().find(".custom_field_is_group_name").css("visibility","hidden")}).change()})}),e.hasClass("multi_input_block_element"),e.children(".multi_input_block").children(".multi_input_holder").length,e.children(".multi_input_block").children(".remove_multi_input_block").off("click").on("click",function(){if(confirm(mvx_vendor_shipping_script_data.multiblock_delete_confirm)){var t=i(this).parent().parent(),e=t.children(".multi_input_block").children(".add_multi_input_block").clone(!0);i(this).parent().remove(),t.children(".multi_input_block").children(".add_multi_input_block").remove(),t.children(".multi_input_block:last").append(e),1==t.children(".multi_input_block").length&&t.children(".multi_input_block").children(".remove_multi_input_block").css("display","none"),t.children(".multi_input_block").length==n?t.find(".add_multi_input_block").hide():t.find(".add_multi_input_block").show()}}),e.find(".field_type_options").each(function(){i(this).off("change").on("change",function(){i(this).parent().find(".field_type_select_options").hide(),i(this).parent().find(".field_type_html_options").hide(),"select"==i(this).val()?i(this).parent().find(".field_type_select_options").show():"mselect"==i(this).val()?i(this).parent().find(".field_type_select_options").show():"dropdown"==i(this).val()?i(this).parent().find(".field_type_select_options").show():"html"==i(this).val()&&i(this).parent().find(".field_type_html_options").show()}).change()}),e.find(".custom_field_is_group").each(function(){i(this).change(function(){i(this).is(":checked")?i(this).parent().find(".custom_field_is_group_name").css("visibility","visible"):i(this).parent().find(".custom_field_is_group_name").css("visibility","hidden")}).change()})})(i(this))})}(jQuery);